# 专项写作工具总结

## 概述

本次更新为写作练习平台新增了9个写作工具，包括8个专项训练工具和1个作文步骤导航工具。这些工具旨在帮助学生更系统地掌握写作技巧，从基础的描写方法到整体的作文结构都有所涵盖。同时，还实现了作文版本历史管理功能，支持多版本对比和删除。

## 新增工具列表

### 专项训练工具

1. **人物语言描写** (tool-51) - 学习如何生动地描写人物的语言
2. **动作描写** (tool-52) - 掌握精准的动作描写技巧
3. **神态描写** (tool-53) - 学会通过神态展现人物内心
4. **提示语的变化** (tool-54) - 丰富对话中的提示语表达
5. **心理描写** (tool-55) - 深入刻画人物内心活动
6. **写景与状物** (tool-56) - 生动描绘环境和物品
7. **人物外貌描写** (tool-57) - 准确描绘人物外貌特征
8. **一波三折** (tool-58) - 学会构建有起伏的故事情节

### 导航工具

9. **作文步骤** (writing-steps) - 综合性写作指导工具，整合所有子工具

## 工具特点

### 1. 层次化结构
- 所有专项工具都作为"具体化"(tool-1)的子工具
- "作文步骤"(writing-steps)作为顶层导航工具，包含所有核心工具
- 某些专项工具也作为其他核心工具的子工具，形成网状结构

### 2. 内容配置化
- 所有工具的指导内容都通过`guidance`字段配置在工具定义中
- 包含核心概念、技巧、练习阶段和自查清单四个部分
- 页面组件动态读取工具定义显示指导内容

### 3. 渐进式解锁
- 每个工具都设置了解锁条件
- 基于前置工具完成情况、掌握程度、练习次数等条件逐步解锁
- 确保学生按正确顺序学习

## 作文版本历史功能

### 功能特性
- **两栏布局**: 每个版本卡片分为左右两栏，左侧显示文章内容，右侧显示批改反馈
- **版本删除**: 支持删除不需要的版本，保留最少一个主版本
- **兄弟版本切换**: 支持在同一层级的不同版本间切换对比
- **路径导航**: 自动构建从根版本到当前版本的显示路径
- **状态同步**: 删除版本时自动更新当前选中状态

### 技术实现
- **状态管理**: 在Zustand store中实现`deleteEssayVersion`函数
- **组件设计**: `SimplifiedVersionHistory`组件负责版本历史显示和交互
- **确认机制**: 使用`ConfirmDialog`组件防止误删除
- **通知系统**: 集成`NotificationContext`提供操作反馈

### 使用流程
1. **查看历史**: 在"我的作文"页面选择作文查看修改历史
2. **版本对比**: 点击不同版本查看内容和反馈对比
3. **删除版本**: 点击删除按钮移除不需要的版本
4. **继续编辑**: 基于任意版本继续编辑创建新版本

## 使用方法

### 专项训练工具使用流程

1. **前置准备**：确保已完成前置工具的学习
2. **理论学习**：阅读工具页面的核心概念和技巧说明
3. **技巧实践**：参考示例完成练习任务
4. **阶段练习**：按练习阶段逐步提升
5. **自我检查**：使用自查清单评估掌握情况
6. **实际应用**：在写作中尝试运用所学技巧

### 作文步骤工具使用流程

1. **整体规划**：从作文步骤工具开始，了解整体写作流程
2. **选择技巧**：根据写作需要选择相应的专项技巧
3. **分步实施**：按步骤应用不同的写作技巧
4. **综合运用**：将多种技巧融合在一篇文章中
5. **检查完善**：使用最后检查工具完善文章

### 版本历史使用流程

1. **保存版本**: 在写作过程中保存多个版本
2. **查看对比**: 在作文详情页面查看不同版本的内容和反馈
3. **删除清理**: 删除不需要的中间版本，保持历史清晰
4. **继续迭代**: 基于最佳版本继续修改完善

## 技术实现

### 工具定义结构

每个工具在`src/data/tools.ts`中定义，包含以下核心字段：

```typescript
{
  id: string,           // 工具唯一标识
  name: string,         // 工具名称
  title: string,        // 工具标题
  description: string,  // 工具描述
  mantra: string,       // 口诀
  tips: string,         // 使用技巧
  suitableFor: string,  // 适用场景
  caution: string,      // 注意事项
  examples: Array,      // 示例对比
  exercises: Array,     // 练习任务
  comprehensionTest: Object, // 理解测试
  unlockConditions: Object,  // 解锁条件
  guidance: Object      // 具体指导内容
}
```

### 指导内容结构

`guidance`字段包含以下子字段：

- `coreConcepts`: 核心概念列表
- `techniques`: 技巧说明数组，每个技巧包含名称、描述和示例
- `practiceStages`: 练习阶段，每个阶段包含阶段名称和任务列表
- `selfCheck`: 自查清单

### 工具关联配置

工具间的父子关系在`src/lib/tool-config.ts`中配置：

- `topLevelToolsConfig`: 顶层工具配置
- `subToolToParentMap`: 子工具到父工具的映射
- `sharedSubTools`: 复用的子工具列表

### 版本历史组件

- `SimplifiedVersionHistory`: 简化版本历史组件，实现两栏布局和删除功能
- `EssayVersion`: 作文版本数据结构，包含父子关系信息
- `deleteEssayVersion`: Zustand store中的版本删除函数

## 注意事项

1. **学习顺序**：建议按工具解锁顺序学习，确保基础扎实
2. **内容配置**：所有指导内容都配置在工具定义中，不在页面代码中硬编码
3. **渐进解锁**：工具解锁基于学习进度，不能跳过前置条件
4. **实际应用**：专项技巧需要在实际写作中反复练习才能掌握
5. **版本管理**：合理使用版本历史功能，避免保存过多无意义的中间版本